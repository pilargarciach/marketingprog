---
title: Formación de Habilidades en Maestrías de Marketing Acreditadas en AACSB
format: html
keywords:
  - Oferta de Maestrías en Marketing
  - Programas de Acreditados en AACSB
  - Redes Bipartitas
  - Modelos de Grafo Exponencial Aleatorio
abstract: |
  Las necesidades actuales del mercado laboral están incidiendo sobre la oferta de la educación universitaria para promocionar la formación de diversas habilidades en los folletos promocionales que describen el propósito y el perfil de sus egresados. En esta investigación se modela a través de redes bipartitas y grafos exponenciales aleatorios la relación cuantitativa entre las habilidaes y la oferta comercial de maestrías de marketing con estándares de acreditación de la "_Association to Advance Collegiate Schools of Business_" ([AACSB](https://www.aacsb.edu/members?educations=masters)).
---

# Introducción

El valor de las habilidades o competencias y su vínculo con el alto rendimiento en el trabajo es una idea bien establecida desde hace décadas [@Spencer1993]. La investigación sobre las habilidades cuenta con varias aproximaciones conceptuales y metodológicas, entre las que resalta una enfoque que aprovecha el concepto de "datos relacionales" [@Butts2008]. Con datos relacionales se pueden analizar cuantitativamente las relaciones multivariadas entre las habilidades y los conocimientos educativos necesarios para ejecutar con destreza las tareas cotidianas de un puesto de trabajo. Esa multiplicidad de relaciones se conceptualizó como un red compleja de información ocupacional [@Peterson2001]. Dicha red compleja de información ocupacional ha estimulado una fructífera línea de investigación sobre competencias en varios países, incluyendo a los Estados Unidos de América [@Borner2018;@Vista2020], Hungría [@Gadar2018], o Colombia [@Garciachitiva2024] por mencionar unos pocos. 

En este reporte, usamos el perfil de habilidades asociadas con la posición de gerentes de marketing descrito en la red de información ocupacional disponible en [O*NET](https://www.onetonline.org/link/table/details/sk/11-2021.00/Skills_11-2021-00.xlsx?fmt=xlsx&s=IM&t=-10) para medir la cercanía de estas habilidades con la oferta académica de programas de maestría en marketing por parte de universidades que cuentan con la acreditación de la la "_Association to Advance Collegiate Schools of Business_" ([AACSB](https://www.aacsb.edu/members?educations=masters)). 

# Contexto Empírico de los datos

Para investigar la relación entre la oferta académica de los programas de maestría en marketing y el perfil profesional de ejecutivos de marketing según O*NET, aprovechamos la técnica conocida como "_búsqueda de palabras clave en contexto_" [@Benoit2018]. Esta técnica permite extraer de los folletos que promocionan los programas de marketing aquellas palabras o frases que describen las habilidades que debe reunir un profesional de marketing. Para realizar esta búsqueda, sin embargo, primero se hace necesario construir un corpus lingüístico digital en el que se registra palabra por palabra cada folleto de marketing. 

```{r, message=FALSE}
library(readtext)
textos <- readtext("Programs/")
library(readr)
AU <- read_csv("Accredited Universities.csv")
colnames(AU)[4] <- "SchoolType"
library(tools)
textos$institution <- file_path_sans_ext(textos$doc_id)
textos$Institution <- gsub("^P\\w+(\\.)?", "", textos$institution)
textos$Institution <- gsub("\\.docx$", "", textos$Institution)
textos$Institution <- sub("^ ", "", textos$Institution)
textos$institution <- NULL
library(tidyverse)
textos <- left_join(textos, AU, by = "Institution", keep = FALSE)
Institutions <- data.frame(table(textos$Institution))
```

## Elaboración del Corpus Lingüístico

Con el muestreo de estos folletos a partir de la información disponible en la página web oficial de la AACSB, procedimos a elaborar un corpus lingüístico de folletos de maestrías en marketing ofrecidas por 81 universidades públicas y 182 privadas, distribuidas en las siguientes tres regiones continentales: "Americas" (AM), "Asia-Pacífico" (AP) y "Europa-Medio Oriente-Africa" (EU-ME-AF). La elaboración del corpus lingüístico fue desarrollada con asistencia de la librería "`quanteda`" [@Benoit2018].

```{r, message=FALSE}
library(quanteda)
Textos <- corpus(textos$text)
docvars(Textos, "Region") <- textos$Region
docvars(Textos, "Institution") <- textos$Institution
docvars(Textos, "InstitutionType") <- textos$SchoolType
TextosData <- as.data.frame(summary(Textos, n = length(textos$text)))

library(readr)
Inst <- read_csv("GeolocationInstitutions.csv")
library(treemap)
colnames(Inst)[1] <- "School Type"
colnames(Inst)[2] <- "Geolocation"
colnames(Inst)[3] <- "value"

library(treemap)
treemap(Inst,
        index=c("Geolocation", "School Type"),
        vSize="value",
        vColor = "School Type",
        type="index",
        title = "",
        algorithm = "pivotSize",
        mirror.x = TRUE,
        mirror.y = FALSE,
        palette = "Set1")
```

Para la elaboración automatizada del corpus lingüístico se procedió a tokenizar palabra por palabra cada documento muestreado, removiendo números, signos de puntuación, direcciones URL y simbólos alfanuméricos para depurar la muestra de textos con la remoción de palabras comunes como artículos, adjetivos y conectores que no aportan información semántica relevante a este contexto.

```{r}
Programs <- tokens(Textos, 
                     remove_numbers = TRUE, 
                     remove_punct = TRUE, 
                     remove_url = TRUE, 
                     remove_symbols = TRUE) %>%  
  tokens_remove(stopwords("english"))
```

## Construcción de diccionario de habilidades

Llegados a este punto, pasamos a desarrollar un diccionario ad-hoc de habilidades que reflejen las habilidades del ejecutivo de marketing que describe O*NET.

```{r}
s1 <- data.frame(kwic(Programs, pattern = c(phrase("active learning"),
                                             phrase("new information"),
                                             phrase("future problem solving"),
                                             phrase("future decision-making"),
                                             phrase("implication"),
                                             phrase("implications"),
                                             phrase("current problems"),
                                             phrase("current solutions"),
                                             phrase("strategic marketing"))))
s1$Competence <- "Active Learning"
s1$SkillCode <- "S1"

s2 <- data.frame(kwic(Programs, pattern = c(phrase("active listening"),
                                            phrase("listening skills"),
                                            phrase("effective listening"),
                                            phrase("attentive listening"),
                                            phrase("listen actively"),
                                            phrase("understand others"),
                                            phrase("engaged listening"),
                                            phrase("client insights"),
                                            phrase("responsive listening"),
                                            phrase("listening to feedback"),
                                            phrase("customer feedback"),
                                            phrase("listening to clients"),
                                            phrase("mindfulness"),
                                            phrase("understanding"),
                                            phrase("information retention"),
                                            phrase("paraphrasing"))))
s2$Competence <- "Active Listening"
s2$SkillCode <- "S2"

s3 <- data.frame(kwic(Programs, pattern = c(phrase("critical thinking"),
                                            phrase("think critically"), 
                                            phrase("critical analysis"),
                                            phrase("reasoning skills"),
                                            phrase("analytical thinking"),
                                            phrase("evaluative thinking"),
                                            phrase("critical evaluation"),
                                            phrase("strategic analysis"),
                                            phrase("problem analysis"),
                                            phrase("critical problem solving"),
                                            phrase("analytical reasoning"),
                                            phrase("evaluating information"),
                                            phrase("argumentation"),
                                            phrase("logic"),
                                            phrase("reasoning"),
                                            phrase("complex problem-solving"))))
s3$Competence <- "Critical Thinking"
s3$SkillCode <- "S3"


s4 <- data.frame(kwic(Programs, pattern = c(phrase("reading comprehension"),
                                            phrase("written sentences"), 
                                            phrase("understanding documents"),
                                            phrase("work-related documents"),
                                            phrase("read"),
                                            phrase("reading communications"),
                                            phrase("understanding texts"))))
s4$Competence <- "Reading Comprehension"
s4$SkillCode <- "S4"

s5 <- data.frame(kwic(Programs, pattern = c(phrase("social perception"),
                                            phrase("empathy"), 
                                            phrase("understanding others"),
                                            phrase("social awareness"),
                                            phrase("social sensitivity"),
                                            phrase("others reactions"),
                                            phrase("social behavior"))))
s5$Competence <- "Social Perceptiveness"
s5$SkillCode <- "S5"

s6 <- data.frame(kwic(Programs, pattern = c(phrase("oral communication"), 
                                            phrase("verbal communication"),
                                            phrase("public speaking"),
                                            phrase("presentation skills"),
                                            phrase("speak confidently"),
                                            phrase("effective speaking"),
                                            phrase("presentation delivery"),
                                            phrase("communication proficiency"),
                                            phrase("communicate effectively"),
                                            phrase("verbal presentations"),
                                            phrase("oral presentations"),
                                            phrase("elocution"),
                                            phrase("storytelling"),
                                            phrase("speaking"),
                                            phrase("rapport building"),
                                            phrase("intercultural communication"),
                                            phrase("global communication"))))
s6$Competence <- "Speaking"
s6$SkillCode <- "S6"

s7 <- data.frame(kwic(Programs, pattern = c(phrase("decision making"),
                                            phrase("making decisions"),
                                            phrase("judgment skills"),
                                            phrase("decisive action"),
                                            phrase("evaluate options"),
                                            phrase("choose solutions"),
                                            phrase("decision strategies"),
                                            phrase("strategic decision making"),
                                            phrase("decisive judgment"),
                                            phrase("business decision making"),
                                            phrase("executive decision making"),
                                            phrase("critical judgment"),
                                            phrase("risk assessment"),
                                            phrase("intuition"),
                                            phrase("experience"),
                                            phrase("confidence"),
                                            phrase("accountability"),
                                            phrase("leadership"))))
s7$Competence <- "Judgment and Decision Making"
s7$SkillCode <- "S7"


s8 <- data.frame(kwic(Programs, pattern = c(phrase("monitoring"), 
                                           phrase("assessing performance"),
                                           phrase("self-assessment"),
                                           phrase("corrective action"),
                                           phrase("make improvement"),
                                           phrase("organization performance"),
                                           phrase("individual performance"),
                                           phrase("enhance"),
                                           phrase("enhancement"))))
s8$Competence <- "Monitoring"
s8$SkillCode <- "S8"

s9 <- data.frame(kwic(Programs, pattern = c(phrase("persuading"), 
                                         phrase("persuading others"),
                                         phrase("persuading skills"),
                                         phrase("influencing others"),
                                         phrase("convincing others"),
                                         phrase("selling ideas"),
                                         phrase("effective persuasion"),
                                         phrase("persuasive communication"),
                                         phrase("influence marketing"),
                                         phrase("marketing influence"),
                                         phrase("persuasive skills"),
                                         phrase("persuasive strategies"),
                                         phrase("social influence"),
                                         phrase("argumentation"),
                                         phrase("appealing to emotions"),
                                         phrase("motivation"),
                                         phrase("credibility"),
                                         phrase("trust"),
                                         phrase("convince"),
                                         phrase("persuasion"),
                                         phrase("change behavior"),
                                         phrase("change minds"),
                                         phrase("persuade"))))
s9$Competence <- "Persuasion"
s9$SkillCode <- "S9"


s10 <- data.frame(kwic(Programs, pattern = c(phrase("solving complex problems"),
                                              phrase("problem solving"),
                                              phrase("resolve issues"),
                                              phrase("troubleshooting"),
                                              phrase("conflict resolution"),
                                              phrase("creative solutions"),
                                              phrase("address challenges"),
                                              phrase("problem resolution"),
                                              phrase("overcome obstacles"),
                                              phrase("complex problem solving"),
                                              phrase("strategic problem solving"),
                                              phrase("problem analysis"),
                                              phrase("root cause identification"),
                                              phrase("solution generation"),
                                              phrase("solution evaluation"),
                                              phrase("solution implementation"),
                                              phrase("monitoring and evaluation"),
                                              phrase("adaptability"),
                                              phrase("flexibility"),
                                              phrase("persistence"))))
s10$Competence <- "Complex Problem Solving"
s10$SkillCode <- "S10"

s11 <- data.frame(kwic(Programs, pattern = c(phrase("negotiation"),
                                            phrase("negotiating skills"),
                                            phrase("bargaining"),
                                            phrase("reconcile differences"),
                                            phrase("deal making"),
                                            phrase("conflict resolution"),
                                            phrase("mediate"),
                                            phrase("negotiation tactics"),
                                            phrase("win-win negotiation"),
                                            phrase("negotiation strategies"),
                                            phrase("negotiation skills"),
                                            phrase("business negotiation"),
                                            phrase("contract negotiation"),
                                            phrase("price negotiation"),
                                            phrase("deal negotiation"),
                                            phrase("conflict negotiation"),
                                            phrase("intercultural negotiation"),
                                            phrase("global negotiation"))))
s11$Competence <- "Negotiation"
s11$SkillCode <- "S11"

s12 <- data.frame(kwic(Programs, pattern = c(phrase("coordination"),
                                             phrase("coordinat*"),
                                             phrase("adjusting actions"),
                                             phrase("coordinate behavior"),
                                             phrase("cooperate with others"),
                                             phrase("cooperat*"),
                                             phrase("collaborat*"),
                                             phrase("coordinate tasks"),
                                             phrase("team coordination"),
                                             phrase("organizational skills"),
                                             phrase("work together"),
                                             phrase("task management"),
                                             phrase("coordinating activities"),
                                             phrase("inter-department coordination"),
                                             phrase("coordinated efforts"),
                                             phrase("team coordination strategies"),
                                             phrase("collaborative coordination"),
                                             phrase("project management"),
                                             phrase("effective communication"),
                                             phrase("delegation"),
                                             phrase("conflict resolution"),
                                             phrase("leadership"),
                                             phrase("tracking"),
                                             phrase("evaluation"),
                                             phrase("collaborate with others"))))
s12$Competence <- "Coordination"
s12$SkillCode <- "S12"


s13 <- data.frame(kwic(Programs, pattern = c(phrase("systems evaluation"),
                                             phrase("identifying measures"),
                                             phrase("identifying indicators"),
                                             phrase("system performance"),
                                             phrase("needs"),
                                             phrase("improve performance"),
                                             phrase("correct performance"),
                                             phrase("goals of the system"),
                                             phrase("systems thinking"),
                                             phrase("systemic"))))
s13$Competence <- "Systems Evaluation"
s13$SkillCode <- "S13"


s14 <- data.frame(kwic(Programs, pattern = c(phrase("time management"), 
                                             phrase("timing"),
                                             phrase("managing one's own time"),
                                             phrase("managing time of others"),
                                             phrase("punctual"),
                                             phrase("on time"),
                                             phrase("time management skills"),
                                             phrase("organize time"),
                                             phrase("efficient scheduling"),
                                             phrase("prioritize tasks"),
                                             phrase("time optimization"),
                                             phrase("schedule management"),
                                             phrase("task prioritization"),
                                             phrase("effective time management"),
                                             phrase("time management strategies"),
                                             phrase("organization"),
                                             phrase("planning"),
                                             phrase("delegation"),
                                             phrase("multitasking"),
                                             phrase("stress management"),
                                             phrase("productivity"),
                                             phrase("efficiency"),
                                             phrase("self-discipline"),
                                             phrase("timely"),
                                             phrase("punctuality"))))
s14$Competence <- "Time Management"
s14$SkillCode <- "S14"

s15 <- data.frame(kwic(Programs, pattern = c(phrase("supervision"),
                                             phrase("supervise"),
                                             phrase("supervising"),
                                             phrase("management"),
                                             phrase("manage personnel"),
                                             phrase("manage staff"),
                                             phrase("team leadership"),
                                             phrase("lead teams"),
                                             phrase("employee supervision"),
                                             phrase("staff management"),
                                             phrase("effective supervision"),
                                             phrase("motivation"),
                                             phrase("coaching"),
                                             phrase("team development"),
                                             phrase("performance management"),
                                             phrase("discipline"),
                                             phrase("ethics"),
                                             phrase("change management"))))
s15$Competence <- "Management of Personnel Resources"
s15$SkillCode <- "S15"



s16 <- data.frame(kwic(Programs, pattern = c(phrase("operation analysis"),
                                             phrase("analyzing needs"),
                                             phrase("analysing needs"),
                                             phrase("product requirement"),
                                             phrase("create designs"),
                                             phrase("designing products"),
                                             phrase("product design"),
                                             phrase("marketing products"),
                                             phrase("design of products"))))
s16$Competence <- "Operations Analysis"
s16$SkillCode <- "S16"


s17 <- data.frame(kwic(Programs, pattern = c(phrase("systems analysis"),
                                             phrase("determining how"),
                                             phrase("software"),
                                             phrase("systems should work"),
                                             phrase("outcome changes"),
                                             phrase("system conditions"),
                                             phrase("system functioning"),
                                             phrase("working system"),
                                             phrase("system operations"))))
s17$Competence <- "Systems Analysis"
s17$SkillCode <- "S17"

s18 <- data.frame(kwic(Programs, pattern = c(phrase("written communication"),
                                            phrase("writing skills"),
                                            phrase("professional writing"),
                                            phrase("report writing"),
                                            phrase("business writing"),
                                            phrase("create marketing content"),
                                            phrase("marketing reports"),
                                            phrase("content creation"),
                                            phrase("marketing copywriting"),
                                            phrase("marketing messages"),
                                            phrase("written marketing materials"),
                                            phrase("writing for marketing"),
                                            phrase("persuasive writing"),
                                            phrase("creative writing"),
                                            phrase("proposal writing"),
                                            phrase("copywriting"),
                                            phrase("web content writing"),
                                            phrase("blogging"),
                                            phrase("social media writing"))))
s18$Competence <- "Writing"
s18$SkillCode <- "S18"


s19 <- data.frame(kwic(Programs, pattern = c(phrase("learning strategies"),
                                             phrase("learning strategy"),
                                             phrase("teaching strategy"),
                                             phrase("teaching strategies"),
                                             phrase("training"),
                                             phrase("instructional methods"),
                                             phrase("appropriate learning"),
                                             phrase("teaching new things"),
                                             phrase("learning new things"),
                                             phrase("selecting and using"),
                                             phrase("learning procedures"))))
s19$Competence <- "Learning Strategies"
s19$SkillCode <- "S19"


s20 <- data.frame(kwic(Programs, pattern = c(phrase("service orientation"),
                                            phrase("customer service"),
                                            phrase("client service"),
                                            phrase("service skills"),
                                            phrase("customer satisfaction"),
                                            phrase("service excellence"),
                                            phrase("client relations"),
                                            phrase("customer care"),
                                            phrase("service delivery"),
                                            phrase("customer-centric approach"),
                                            phrase("service-oriented"),
                                            phrase("customer-focused"),
                                            phrase("customer loyalty"),
                                            phrase("positive attitude"),
                                            phrase("proactivity"),
                                            phrase("teamwork"))))
s20$Competence <- "Service Orientation"
s20$SkillCode <- "S20"


s21 <- data.frame(kwic(Programs, pattern = c(phrase("instructing"),
                                             phrase("teaching others"),
                                             phrase("how to do"),
                                             phrase("explain to others"),
                                             phrase("explaining"),
                                             phrase("teaching"),
                                             phrase("explanation"),
                                             phrase("how to deal with"),
                                             phrase("how to solve"))))
s21$Competence <- "Instructing"
s21$SkillCode <- "S21"

s22 <- data.frame(kwic(Programs, pattern = c(phrase("financial resources"),
                                             phrase("money management"),
                                             phrase("financial management"),
                                             phrase("assets"),
                                             phrase("cash"),
                                             phrase("cash flow"),
                                             phrase("ROI"),
                                             phrase("investment"),
                                             phrase("liabilities"),
                                             phrase("expenditure"),
                                             phrase("purchase"),
                                             phrase("profit*"),
                                             phrase("business analytics"),
                                             phrase("acquisition"),
                                             phrase("budget*"),
                                             phrase("costs"))))
s22$Competence <- "Management of Financial Resources"
s22$SkillCode <- "S22"


s23 <- data.frame(kwic(Programs, pattern = c(phrase("mathematics"),
                                             phrase("mathematical thinking"),
                                             phrase("maths"),
                                             phrase("statistics"),
                                             phrase("data analytics"),
                                             phrase("solve problems"),
                                             phrase("calculation"),
                                             phrase("abstract thinking"))))
s23$Competence <- "Mathematics"
s23$SkillCode <- "S23"


s24 <- data.frame(kwic(Programs, pattern = c(phrase("material resources"),
                                             phrase("equipment*"),
                                             phrase("supplies"),
                                             phrase("facilities"),
                                             phrase("pop material"),
                                             phrase("merch"),
                                             phrase("merchandise"),
                                             phrase("materials"))))
s24$Competence <- "Management of Material Resources"
s24$SkillCode <- "S24"


s25 <- data.frame(kwic(Programs, pattern = c(phrase("programming"),
                                             phrase("computer programs"),
                                             phrase("object oriented programming"),
                                             phrase("SQL"),
                                             phrase("no-code"),
                                             phrase("Excel"),
                                             phrase("MySQL"),
                                             phrase("Python"),
                                             phrase("STATA"),
                                             phrase("AWS"),
                                             phrase("Salesforce"),
                                             phrase("Google"),
                                             phrase("data analytics"),
                                             phrase("SPSS"))))
s25$Competence <- "Programming"
s25$SkillCode <- "S25"

s26 <- data.frame(kwic(Programs, pattern = c(phrase("quality"),
                                             phrase("performance quality"),
                                             phrase("quality control"),
                                             phrase("quality test"),
                                             phrase("quality assessment"),
                                             phrase("service inspection"),
                                             phrase("quality standard"),
                                             phrase("quality analysis"),
                                             phrase("product inspection"))))
s26$Competence <- "Quality Control Analysis"
s26$SkillCode <- "S26"

s27 <- data.frame(kwic(Programs, pattern = c(phrase("operations monitoring"),
                                             phrase("watch gauges"),
                                             phrase("dashboard"),
                                             phrase("wacth dials"),
                                             phrase("kpi"),
                                             phrase("control panel"),
                                             phrase("indicator*"),
                                             phrase("watch dashboards"),
                                             phrase("machine functioning"),
                                             phrase("machine working"))))
s27$Competence <- "Operations Monitoring"
s27$SkillCode <- "S27"

s28 <- data.frame(kwic(Programs, pattern = c(phrase("sciences"),
                                             phrase("data science"),
                                             phrase("scientific thinking"),
                                             phrase("scientific method"),
                                             phrase("scientific analysis"),
                                             phrase("scientific methods"),
                                             phrase("scientific solutions"))))
s28$Competence <- "Science"
s28$SkillCode <- "S28"


s29 <- data.frame(kwic(Programs, pattern = c(phrase("technology design"),
                                             phrase("technology adaptation"),
                                             phrase("technology generation"),
                                             phrase("digital technology"),
                                             phrase("artificial intelligence"),
                                             phrase("user needs"),
                                             phrase("technological solution"),
                                             phrase("technological equipment"),
                                             phrase("technology training"),
                                             phrase("technology deployment"))))
s29$Competence <- "Technology Design"
s29$SkillCode <- "S29"


df_list <- mget(paste0("s", 1:29))
SS <- do.call(rbind, df_list)
patrones <- data.frame(table(SS$pattern))
Patrones <- data.frame(table(SS$Competence))
SS <- merge(SS, TextosData, by.x = "docname", by.y = "Text")
```

## Construcción de la matriz término-documento
Con la construcción del diccionario de habilidades, ahora es posible pasar a  construir una matriz rectangular término-documento [@Benoit2018]. Esta matriz término-documento está compuesta por un número _n_ de filas y un número _c_ de columnas, donde las habilidades se disponen en filas y los programas en columnas y los valores en las celdas de tal matriz solo pueden tener dos valores posibles (i.e., 1 para indicar que la habilidad está explícitamente mencionada en el folleto que promociona el programa o cero para indicar lo contrario).

```{r, message=FALSE, warning=FALSE}
Network <- SS[c(8,1,10:15)]
rm(list=setdiff(ls(), c("Network", "SS")))
Network$Competence <- tolower(Network$Competence)

network <- Network[!duplicated(Network[c(1,2,4,6,7)]),]
```


## Configuración de la matriz término-documento como red bipartita

Ahora nuestro próximo paso consiste en configurar la matriz término-documento como una red bipartita para lo cual se necesita usar la librería `igraph` [@Csardi2024]. A continuación mostramos una fracción de dicha matriz al revelar las primeras cinco filas y las primeras cinco columnas. 

```{r, warning=FALSE, message=FALSE}
library(igraph)
bn2 <- graph_from_data_frame(network,directed=FALSE)
V(bn2)$type <- bipartite_mapping(bn2)$type

BiM <- as_biadjacency_matrix(bn2, types = V(bn2)$type, names = TRUE)
BiM[1:5,1:5]
```


# Especificación y modelación de red bipartita como grafo aleatorio

Llegados a este punto, ahora pasamos a definir la red bipartita como un grafo aleatorio. La hipótesis básica de este grafo aleatorio implica que el número de conexiones entre habilidades y programas es "esperable por azar". Este número, en terminología de grafos exponenciales aleatorios, está representado por el concepto de densidad de red, la cual se obtiene con el uso de la librería `network` [@Butts2008] y la librería `ergm` [@Krivistky2023].

```{r, warning=FALSE, message=FALSE}
library(network)
red <- network(BiM, 
               directed = FALSE, 
               hyper = FALSE, 
               loops = FALSE, 
               multiple = FALSE, 
               bipartite = TRUE)
is.network(red)

library(network)
library(ergm)
library(coda)
sna::gden(red)
```

En esta red bipartita, las habilidades son definidas como nodos de la primera partición y los folletos promocionales de los programas de marketing se definen como los nodos de la segunda partición. A esta red se le pueden adjuntar atributos a dichos nodos de la siguiente manera.

```{r, echo=FALSE}
seleccionados <- unique(network$docname)
load("Results/Result1.RData")
todos <- unique(TextosData$Text)
```

Los nodos de la primera partición (habilidades) tienen un atributo llamado `OnetImportance` que refleja la importancia de dicha habilidad según la red de información ocupacional O*NET. Otro atributo aplica para los nodos de la segunda partición (programas) se llama `SchoolType` para reflejar si el programa proviene de una universidad pública o privada. Otro atributo llamado `Region` también aplica para la segunda partición (programas) para reflejar si el programa es de una universidad ubicada geográficamente en la región Asia-Pacífico, Americas, o Europa-Medio Oriente-Africa.

```{r, message=FALSE, warning=FALSE}
ProgramAttributes <- TextosData[TextosData$Text %in% seleccionados, ]
SkillAttributes <- data.frame(Competence = unique(SS$Competence))
library(readr)
ONET_SkillsImportance <- read_csv("ONET_SkillsImportance.csv")
SkillAttributes <- merge(SkillAttributes, ONET_SkillsImportance, by.x = "Competence", by.y = "Skill", all.x = TRUE)
set.vertex.attribute(red, "OnetImportance", SkillAttributes$Importance)
OnetImportance <- data.frame(OnetImportance = get.vertex.attribute(red, "OnetImportance"))
OnetImportance$OnetImportance[29:286] <- 0 
SchoolType <- data.frame(SchoolType = c(rep(0, 28), ProgramAttributes$InstitutionType))
Region <- data.frame(Region = c(rep(0,28), ProgramAttributes$Region))
set.vertex.attribute(red, "SchoolType", SchoolType$SchoolType)
set.vertex.attribute(red, "OnetImportance", OnetImportance$OnetImportance)
set.vertex.attribute(red, "Region", Region$Region)
```


La red bipartita queda entonces conformada con 287 nodos, distribuidos en 29 nodos para la primera partición (habilidades) y 258 nodos para la segunda partición (programas) conectados a través de 2147 aristas.

```{r}
red
```

# Contraste de Hipótesis 

El contraste de hipótesis sobre la red bipartita que representa la relación entre habilidades y programas contempla el planteamiento y contrastación empírica de una serie de modelos que se enumeran a continuación.

## La conectividad de la red no ocurre por azar

Nuestro primer contraste de hipótesis supone descartar la idea de que la conexión entre habilidades y programas ocurre por azar. En otras palabras, debemos conocer si el total de conexiones está muy por encima o muy por debajo de lo que puede esperarse por azar. 

```{r, message=FALSE}
set.seed(1107)
model0 <- ergm(red ~ edges, control = control.ergm(
  MCMC.burnin = 10000,
  MCMC.interval = 100
))
summary(model0)
```

Este primer modelo debe considerarse un modelo de línea base ya que solo incluye el término `edges`, lo que implica que la probabilidad de una conexión entre dos nodos es constante en toda la red. El coeficiente estimado para `edges` es -0.91022, lo que indica una tendencia negativa a formar enlaces (por debajo de lo esperado por azar). Es esencial interpretar este coeficiente en conjunto con otros términos del modelo (en modelos posteriores). El coeficiente es altamente significativo (p-valor < 0.001), lo que sugiere que el número de enlaces es diferente de lo esperado por casualidad. La desviación nula y residual indican cuánto se reduce la falta de ajuste del modelo en comparación con un modelo nulo sin predictores. Los valores de AIC (Akaike Information Criterion) y BIC (Bayesian Information Criterion) son medidas de ajuste del modelo, y mientras más cercanos a cero tanto mejor el ajuste del modelo. Estos dos valores los usaremos para comparar este primer modelo que sirve como línea base para incorporar otros predictores.

## La conectividad de la red se explica por un grupo limitado de habilidades

Un segundo modelo implica contrastar la hipótesis según la cual las habilidades más relevantes son las que mayor presencia tienen en los folletos promocionales de las maestrías de marketing. 

```{r, message=FALSE}
model1 <- ergm(red ~ edges + b1sociality(nodes = c(1:28)))
summary(model1)
```

